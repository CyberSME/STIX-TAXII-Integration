soltra2juniperfw

About

soltra2juniperfw is a simple python script that converts the MS-ISAC Soltra Edge AttackingIPs feed into firewall filters on your remote juniper Firewall to block outgoing traffic to malicious IPs and domains.

The AttackingIPs feed contains observables in the form of IP addresses and domains that have been detected to be malicious by the MS-ISAC SOC.

The filters created by this script are meant to be applied to an Interface Firewall Filter that is applied to egress traffic to the internet on the Juniper Firewall.

Each occurance that the script is run, it will log a new term (indicated by the date and time in which it was ran) within a Firewall Filter titled MSISAC_Soltra. This will allow tracking of when IPs and domain were added to the filter, and you/we can easily identify false positives. We have also enabled a counter for the filter to track how many packets that the filter is dropping.

*******************************

Authentication is required to access the feeds from the MS-ISAC Soltra Edge server.
If you wish to gain access to the feeds, please email a request to soc@msisac.org.

Usage

$ python soltra2juniperfw.py
Enter your MS-ISAC Soltra Username -> <username>
Enter your MS-ISAC Soltra Password ->  <password>
Enter your local directory location to store IPs/domains -> <dir>
Enter the IP address of the juniper firewall -> <ip>
Enter the SSH username for the juniper firewall -> <username>
Enter the SSH password for the juniper firewall -> <password>
Enter the enable password for the juniper firewall -> <password>
Enter the Interface for the Juniper firewall -> <interface>

These prompts can be avoided by adding this information to the script itself just under the import section near the top of the file:

### EDIT THIS SECTION ###

# username:password for the Soltra Edge server we are polling from
# example: "username:password"
user_pwd = ""

# Directory to store IPs and Domains to be added as firewall rules
# example: "/home/user/soltra-fw-rules/"
outputLocation = ""

# IP address of the Juniper firewall
Juniperip = ""

# SSH username and password for Juniper firewall
Juniperusr = ""
Juniperpwd = ""

# Interface on Firewall (EX: ge-1/1/0)
Juniperif = ""

#########################


On the first run, this script will convert all observables from the AttackingIPs feed in the last month to firewall rules.
Each run after the initial will convert observables from the last 7 days.

This is intended to be added to your a system as a cron job to be run each week in order to add the newest malicious IP addresses and domains to your firewall rules.

This can be done by adding the following to your crontab:
$ crontab -e

append this line to run soltra2snort every Tuesday at midnight:
0 0 * * 2 python /path/to/soltra2juniperfw.py
